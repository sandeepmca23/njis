MFA: Request 1: { "datasource": "NJIIS", "action": "GENERATE_TOTAC", "userName": "mpuram" } Success Response: {"body":{"status":"SUCCESS","message":"COMPLETE","json":{"authType":"MFA"}},"statusCode":"OK","statusCodeValue":200} Request 2: { "datasource": "NJIIS", "action": "VALIDATE_MFA_TOTAC", "userName": "mpuram", "password": "Madhu@123", "totac": "218972" } Success Response : {"body":{"status":"SUCCESS","message":"COMPLETE","json":{"authToken":"2036FA86A30359848821B1302C785840DD1A1F377F8436AB663C8F5EB60E71D70BEBE1B5AF11BC29D957956EEEE4EA33BB390C9B0DF60FF09A80A9DF732563E4","userName":"MPURAM","authType":"MFA","callerIdSeq":"16142110"}},"statusCode":"OK","statusCodeValue":200} Failure Response : {"body":{"status":"TRN_ERROR","message":"User Authentication Failed"},"statusCode":"OK","statusCodeValue":200} PLA : Request 1: { "datasource": "NJIIS", "action": "GENERATE_TOTAC", "userName": "mpuram" } Success Response : {"body":{"status":"SUCCESS","message":"COMPLETE","json":{"authType":"PLA","plaId":"KSANKARfUIoirjLsPtOMJLqbARg"}},"statusCode":"OK","statusCodeValue":200} Failure Response : {"body":{"status":"TRN_ERROR","message":"User Authentication Failed"},"statusCode":"OK","statusCodeValue":200} {"body":{"status":"ERROR","message":"Encountered validation error(s)","errors":{"plaId":"plaId is required."}},"statusCode":"OK","statusCodeValue":200} Request 2: { "datasource": "NJIIS", "action": "GET_PLA_AUTH_TOKEN", "plaId": "mpuramsyWnVYwLgtpwWjYKZpJz" } Success scenario: user gets email --- click on link -once verified -user will be directed to dashboard. Failure Response: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ Testing : Server : Broker URL: ws://localhost:18004/core/ms/auth/broker Broker Secure URL: wss://localhost:19004/core/ms/auth/broker Destination: /api/send Subscribe: /topic/subscribe to Test MFA and PLA from home network :D:\Apache\TomEE\Plume-9.1.0\domains\NJIISMicroServices\apps\ms\global\resources edit line 40 to smtp.doh.state.nj.us in global sever application.properties file smtp.doh.state.nj.us https://localhost:19004/core/ms/auth/web/test.html http://localhost:18004/core/ms/auth/web/test.html For PLA 1. User enters user name and hits submit { "datasource": "NJIIS", "action": "GENERATE_TOTAC", "userName": "ksankar" } 2. MW and DB generates TOTAC and emails link to user 3. MW returns control to UI { "status": "SUCCESS", "message": "COMPLETE", "json": { "authType": "PLA", } } 4. UI shows countdown timer and in the background send a async poll request in a loop as long as the status is TRN_IN_PROGRESS or it timesout. { "datasource": "NJIIS", "action": "GET_PLA_AUTH_TOKEN", "plaId": "KSANKARsyWnVYwLgtpwWjYKZpJz" } 5. MW will send the following JSON while waiting for user to click on the PLA link. Continue to poll if authToken is not found. { "status": "SUCCESS", "message": "Successfully executed API.", "json": { "userName": "KSANKAR", "authType": "PLA", "callerIdSeq": "2625249" } } 6. MW will send the following JSON once authenticated. { "status": "SUCCESS", "message": "Successfully executed API.", "json": { "authToken": "8F11C11F595051D61DFB5C7F86091CE7A9A2533317CE32E3D95C6222AA54AA3EFCAABAA7652F3DBE598271FE373057F21B48EB88F8C3D798EFE33D0AE1BDB924", "userName": "KSANKAR", "authType": "PLA", "callerIdSeq": "2625249" } } ----------------------------------------------------------------------------------------- For MFA 1. User enters user name and hits submit { "datasource": "NJIIS", "action": "GENERATE_TOTAC", "userName": "kselvaraj" } 2. MW and DB generates TOTAC and emails raw TOTAC to user 3. MW returns control to UI { "status": "SUCCESS", "message": "COMPLETE", "json": { "authType": "MFA", } } 4. User enters password, TOTAC and hits submit. { "datasource": "NJIIS", "action": "VALIDATE_MFA_TOTAC", "userName": "kselvaraj", "password": "123456", "totac": "709087" } 5. MW and DB validates combo and will send the following JSON once authenticated. "json": { "authToken": "8F11C11F595051D61DFB5C7F86091CE7A9A2533317CE32E3D95C6222AA54AA3EFCAABAA7652F3DBE598271FE373057F21B48EB88F8C3D798EFE33D0AE1BDB924", "userName": "KSELVARAJ", "authType": "MFA", "callerIdSeq": "16141888" }
